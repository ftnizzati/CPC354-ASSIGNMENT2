<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>WebGL Robotic Arm – Controls</title>
</head>

<body>

  <header>
    <h2>WebGL Robotic Arm</h2>
    <p>Use sliders or keyboard to control joints and gripper.</p>
  </header>

  <main>
    <!-- Automation Controls -->
    <section aria-labelledby="automation-title">
      <h3 id="automation-title">Automation Controls</h3>
      
      <fieldset>
        <legend>Pick-and-Place Automation</legend>
        
        <div>
          <button id="start-auto-btn" onclick="gripperAutomation.startPickAndPlace()">▶ Start Automation</button>
          <button id="stop-auto-btn" onclick="gripperAutomation.stopAutomation()" disabled>⏹ Stop</button>
          <button id="reset-arm-btn" onclick="gripperAutomation.resetArm()">↻ Reset Arm</button>
        </div>
        
        <div style="margin-top: 10px;">
          <button onclick="gripperAutomation.openGripper()">⇄ Open Gripper</button>
          <button onclick="gripperAutomation.closeGripper()">⇶ Close Gripper</button>
        </div>
        
        <div style="margin-top: 10px; font-size: 14px;">
          <p><strong>Automation State:</strong> <span id="auto-state">Idle</span></p>
          <p><strong>Gripper State:</strong> <span id="gripper-state">Open</span></p>
          <p><strong>Holding Object:</strong> <span id="holding-state">No</span></p>
          <p><strong>Step:</strong> <span id="step-state">Idle</span></p>
        </div>
        
        <div style="margin-top: 10px; font-size: 12px; color: #666;">
          <p><strong>Keyboard Shortcuts:</strong></p>
          <p>1: Start Automation</p>
          <p>2: Stop Automation</p>
          <p>3: Reset Arm</p>
          <p>4: Open Gripper</p>
          <p>5: Close Gripper</p>
        </div>
      </fieldset>
    </section>

    <!-- Controls -->
    <section aria-labelledby="controls-title">
      <h3 id="controls-title">Controls</h3>

      <fieldset>
        <legend>Joint Angles</legend>

        <p>
          <label for="slider1">Body angle (-180 to 180):</label><br />
          <input id="slider1" type="range" min="-180" max="180" step="10" value="0" />
          <output id="out1">0</output>°
        </p>

        <p>
          <label for="slider2">Lower arm angle (-180 to 180):</label><br />
          <input id="slider2" type="range" min="-180" max="180" step="10" value="0" />
          <output id="out2">0</output>°
        </p>

        <p>
          <label for="slider3">Upper arm angle (-180 to 180):</label><br />
          <input id="slider3" type="range" min="-180" max="180" step="10" value="0" />
          <output id="out3">0</output>°
        </p>
      </fieldset>

      <fieldset>
        <legend>Gripper</legend>

        <p>
          <label for="slider4">Gripper open (0 = close, 100 = open):</label><br />
          <input id="slider4" type="range" min="0" max="100" step="1" value="100" />
          <output id="out4">100</output>
        </p>
      </fieldset>
    </section>

    <!-- Keyboard help -->
    <section aria-labelledby="keys-title">
      <h3 id="keys-title">Keyboard Shortcuts</h3>

      <ul>
        <li><b>A / D</b> = Base (10° / 1° precision)</li>
        <li><b>W / S</b> = Main arm</li>
        <li><b>R / F</b> = Forearm</li>
        <li><b>O / P</b> = Grip</li>
        <li><b>G</b> = Record mode</li>
        <li><b>X</b> or <b>Space</b> = Save position</li>
        <li><b>V</b> = Play mode (loop)</li>
        <li><b>Caps Lock</b> = Precision mode</li>
        <li><b>+</b> / <b>-</b> = Change movement speed</li>
        <li><b>1</b> = Start Automation</li>
        <li><b>2</b> = Stop Automation</li>
        <li><b>3</b> = Reset Arm</li>
        <li><b>4</b> = Open Gripper</li>
        <li><b>5</b> = Close Gripper</li>
      </ul>
    </section>

    <!-- Status -->
    <section aria-labelledby="status-title">
      <h3 id="status-title">Status</h3>
      <div id="status" role="status" aria-live="polite">Ready.</div>
    </section>

    <!-- Canvas -->
    <section aria-labelledby="view-title">
      <h3 id="view-title">Viewport</h3>
      <canvas id="gl-canvas" width="512" height="512">
        Your browser does not support the HTML canvas element.
      </canvas>
    </section>
  </main>

  <!-- Shaders -->
  <script id="vertex-shader" type="x-shader/x-vertex">
#version 300 es
in vec4 aPosition;
in vec4 aColor;
out vec4 vColor;

uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;

void main()
{
    vColor = aColor;
    gl_Position = projectionMatrix * modelViewMatrix * aPosition;
}
  </script>

  <script id="fragment-shader" type="x-shader/x-fragment">
#version 300 es
precision mediump float;

in vec4 vColor;
out vec4 fColor;

void main()
{
    fColor = vColor;
}
  </script>

  <!-- Scripts -->
  <script src="../Common/initShaders.js"></script>
  <script src="../Common/MVnew.js"></script>
  <script src="autoAnimation.js"></script>
  <script src="robotArm.js"></script>

  <!-- Small UX helper (no CSS): show slider values beside outputs -->
  <script>
    (function () {
      function bind(sliderId, outputId) {
        var s = document.getElementById(sliderId);
        var o = document.getElementById(outputId);
        if (!s || !o) return;
        o.value = s.value;
        s.addEventListener("input", function () { o.value = s.value; });
      }
      bind("slider1", "out1");
      bind("slider2", "out2");
      bind("slider3", "out3");
      bind("slider4", "out4");
    })();
  </script>

</body>
</html>